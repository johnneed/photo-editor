{"version":3,"sources":["../../../app/src/editor.js"],"names":[],"mappings":"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","file":"editor.js","sourcesContent":["class Editor {\r\n    constructor(file) {\r\n        var reader = new FileReader();\r\n        var me = this;\r\n        this.canvas = document.createElement('canvas');\r\n        this.canvas.setAttribute('id', 'editorCanvas');\r\n        this.canvasContext = this.canvas.getContext(\"2d\");\r\n        this.imageState = {\r\n            swidth: null,\r\n            sheight: null,\r\n            sx: 0,\r\n            sy: 0,\r\n            height: null,\r\n            width: null,\r\n            x: 0,\r\n            y: 0,\r\n            canvasWidth: null,\r\n            canvasHeight: null\r\n        };\r\n        this.fileName = file.name;\r\n        this.mimeType = file.type;\r\n        this.lastModifiedDate = file.lastModifiedDate;\r\n        this.fileSize = file.size;\r\n        this.history = [];\r\n        this.zoomPercent = 100;\r\n        this.scale = this.scale.bind(this);\r\n        this.redraw = this.redraw.bind(this);\r\n        this.move = this.move.bind(this);\r\n        reader.onload = function (e) {\r\n            me.originalImage = document.createElement('img');\r\n            me.originalImage.setAttribute('src', e.target.result);\r\n            me.imageState.height = me.originalImage.naturalHeight;\r\n            me.imageState.width = me.originalImage.naturalWidth;\r\n            me.imageState.swidth = me.originalImage.naturalWidth;\r\n            me.imageState.sheight = me.originalImage.naturalHeight;\r\n            me.description = me.originalImage.longDesc;\r\n            me.name = me.originalImage.name || me.fileName;\r\n            me.canvas.height = me.originalImage.naturalHeight;\r\n            me.canvas.width = me.originalImage.naturalWidth;\r\n            me.canvasContext.drawImage(me.originalImage, 0, 0);\r\n        };\r\n\r\n        reader.readAsDataURL(file);\r\n    }\r\n\r\n    scale(percentage) {\r\n        console.log(\"scale\" + percentage + \"%\");\r\n        var newHeight = this.originalImage.height * percentage * .01;\r\n        var newWidth = this.originalImage.width * percentage * .01;\r\n        this.imageState.width = newWidth;\r\n        this.imageState.height = newHeight;\r\n        this.canvas.width =newWidth;\r\n        this.canvas.height = newHeight;\r\n        this.redraw();\r\n        this.history.push({\r\n            action: \"zoom\",\r\n            payload: percentage\r\n        });\r\n\r\n    }\r\n\r\n    redraw(args) {\r\n        args = args || {};\r\n        console.log('redraw ' + JSON.stringify(args));\r\n\r\n        var img = this.originalImage;\r\n        var sx = args.sx || this.imageState.sx || 0;\r\n        var sy = args.sy || this.imageState.sy || 0;\r\n        var swidth = args.swidth || this.imageState.swidth;\r\n        var sheight = args.sheight || this.imageState.sheight;\r\n        var x = args.x ? (this.imageState.x || 0) + args.x : (this.imageState.x || 0);\r\n        var y = args.y ? (this.imageState.y || 0) + args.y : (this.imageState.y || 0);\r\n        var width = args.width || this.imageState.width;\r\n        var height = args.height || this.imageState.height;\r\n\r\n        //Clear the canvas\r\n        this.canvasContext.clearRect(0, 0, this.canvas.width, this.canvas.height);\r\n        this.canvasContext.drawImage(img, sx, sy, swidth, sheight, x, y, width, height)\r\n    }\r\n\r\n    drawBox(args) {\r\n        args = args || {};\r\n        // console.log('drawBox ' + JSON.stringify(args));\r\n        this.redraw();\r\n        this.canvasContext.fillStyle = 'rgba(255,255,255,0.5)';\r\n        this.canvasContext.fillRect((args.sx || 0), (args.sy || 0), (args.swidth || 0), (args.sheight || 0));\r\n    }\r\n\r\n\r\n    move(args) {\r\n        args = args || {};\r\n        console.log('move ' + JSON.stringify(args));\r\n        this.imageState.y = this.imageState.y + (args.y || 0);\r\n        this.imageState.x = this.imageState.x + (args.x || 0);\r\n        this.redraw();\r\n    }\r\n\r\n    crop(args) {\r\n        args = args || {};\r\n        console.log('crop ' + JSON.stringify(args));\r\n        this.imageState.x = 0;\r\n        this.imageState.y = 0;\r\n        this.imageState.width = args.swidth;\r\n        this.imageState.height = args.sheight;\r\n        this.imageState.sy = (args.sy || 0);\r\n        this.imageState.sx = (args.sx || 0);\r\n        this.imageState.swidth = (args.swidth || 0);\r\n        this.imageState.sheight = (args.sheight || 0);\r\n        this.canvas.width =args.swidth;\r\n        this.canvas.height = args.sheight;\r\n        this.redraw();\r\n    }\r\n\r\n    rotate(deg){\r\n        var rad = deg * Math.PI / 180;\r\n        this.canvasContext.translate(this.canvas.width/2, this.canvas.height/2);\r\n        this.canvasContext.rotate(rad);\r\n        this.redraw();\r\n        this.canvasContext.translate( -this.canvas.width/2, -this.canvas.height/2);\r\n\r\n    }\r\n\r\n    save() {\r\n        var imgdata = this.canvas.toDataURL('imgage/png');\r\n        // standard data to url\r\n\r\n        // modify the dataUrl so the browser starts downloading it instead of just showing it\r\n        var newdata = imgdata.replace(/^data:image\\/png/, 'data:application/octet-stream');\r\n        return newdata;\r\n        // give the link the values it needs\r\n\r\n    }\r\n}\r\n\r\nexport default Editor;\r\n"]}