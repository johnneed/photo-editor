{"version":3,"sources":["../../../app/src/main.js"],"names":[],"mappings":"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","file":"main.js","sourcesContent":["import {default as Editor} from './editor';\nimport {getOffset} from \"./utilities\";\nimport EditorState from \"./editor-state\";\n\n(function () {\n    \"use strict\";\n\n    var fileInput = document.getElementById(\"fileInput\");\n    var scaleControl = document.getElementById(\"scaleImageControl\");\n    var cropControl = document.getElementById(\"cropImageControl\");\n    var editorBox = document.getElementById(\"editor\");\n    var saveButton = document.getElementById(\"save\");\n    var rotateRight= document.getElementById(\"rotateRight\");\n    var rotateLeft = document.getElementById(\"rotateLeft\");\n    var undoControl = document.getElementById(\"undoControl\");\n    var redoControl = document.getElementById(\"redoControl\");\n    var myEditor;\n    let appState = {\n        mouseStartX : null,\n        mouseStartY : null,\n        mouseEndX : null,\n        mouseEndY : null,\n        offset : null,\n        canvasWidth : null,\n        canvasHeight : null,\n        isMoving : null,\n        isCropping : null\n    };\n\n\n    function addPic(event) {\n        myEditor = new Editor(event.target.files[0]);\n        while (editorBox.hasChildNodes()) {\n            editorBox.removeChild(editorBox.lastChild);\n        }\n        editorBox.appendChild(myEditor.canvas);\n        appState.offset = getOffset(myEditor.canvas)\n\n        appState.canvasWidth = myEditor.canvas.width;\n        appState.canvasHeight = myEditor.canvas.height;\n\n        window.editor = myEditor;\n        saveButton.setAttribute('href', myEditor.save());\n    }\n\n    function scalePic(event) {\n        console.log('scalePic : ' + event.target.value);\n        myEditor.scale(event.target.value);\n    }\n\n    function saveState(event){\n        myEditor.saveState();\n    }\n\n    function startMove(e) {\n        console.log(e);\n        appState.mouseStartX = parseInt(e.clientX, 10);\n        appState.mouseStartY = parseInt(e.clientY, 10);\n        console.log('start-move : X ' + appState.mouseStartX + ' Y ' + appState.mouseStartY);\n        // set the move flag\n        appState.isMoving = true;\n    }\n\n    function moving(e) {\n        var canMouseX = parseInt(e.clientX, 10) - appState.mouseStartX;\n        var canMouseY = parseInt(e.clientY, 10) - appState.mouseStartY;\n        // if the move flag is set, clear the canvas and draw the image\n        if (appState.isMoving) {\n            console.log('move : X ' + canMouseX + ' Y ' + canMouseY);\n            myEditor.move({\n                x: canMouseX,\n                y: canMouseY\n            });\n            //   myEditor.canvasContext.clearRect(0, 0, canvasWidth, canvasHeight);\n            //   myEditor.canvasContext.drawImage(myEditor.originalImage, canMouseX - 128 / 2, canMouseY - 120 / 2, 128, 120);\n        }\n    }\n\n    function endMove(e) {\n        console.log(e);\n        var canMouseX = parseInt(e.clientX, 10) - appState.mouseStartX;\n        var canMouseY = parseInt(e.clientY, 10) - appState.mouseStartY;\n        console.log('end-move : X ' + canMouseX + ' Y ' + canMouseY);\n        if (appState.isMoving) {\n            myEditor.move({\n                x: (canMouseX),\n                y: (canMouseY)\n            });\n            myEditor.saveState();\n        }\n        // clear the move flag\n        appState.isMoving = false;\n    }\n\n\n\n    function startCrop(e) {\n        console.log(e);\n\n        appState.mouseStartX = parseInt(e.clientX, 10);\n        appState.mouseStartY = parseInt(e.clientY, 10);\n        console.log('start-crop : X ' + appState.mouseStartX + ' Y ' + appState.mouseStartY);\n\n        // set the crop flag\n        appState.isCropping = true;\n    }\n\n    function cropping(e) {\n        var canMouseX = parseInt(e.clientX, 10) - appState.mouseStartX;\n        var canMouseY = parseInt(e.clientY, 10) - appState.mouseStartY;\n        // if the crop flag is set, clear the canvas and draw the image\n        if (appState.isCropping) {\n            // console.log('crop : X ' + mouseStartX - offset.left + ' Y ' +  mouseStartY - offset.top);\n\n            myEditor.drawBox({\n                x: appState.mouseStartX - appState.offset.left,\n                y: appState.mouseStartY - appState.offset.top,\n                width : canMouseX,\n                height : canMouseY\n            });\n            //   myEditor.canvasContext.clearRect(0, 0, canvasWidth, canvasHeight);\n            //   myEditor.canvasContext.drawImage(myEditor.originalImage, canMouseX - 128 / 2, canMouseY - 120 / 2, 128, 120);\n        }\n    }\n\n    function endCrop(e) {\n        console.log(e);\n        appState.mouseEndX = parseInt(e.clientX, 10) - appState.mouseStartX;\n        appState.mouseEndY = parseInt(e.clientY, 10) - appState.mouseStartY;\n\n        console.log('end-crop : X ' + appState.mouseEndX + ' Y ' + appState.mouseEndY);\n        if (appState.isCropping) {\n            myEditor.crop({\n                x: (appState.mouseEndX > 0) ?  appState.mouseStartX - appState.offset.left : parseInt(e.clientX, 10) - appState.offset.left,\n                y: (appState.mouseEndY > 0) ?  appState.mouseStartY - appState.offset.top : parseInt(e.clientY, 10) - appState.offset.top,\n                width : Math.abs(appState.mouseEndX),\n                height : Math.abs(appState.mouseEndY)\n            })\n        }\n        // clear the crop flag\n        appState.isCropping = false;\n    }\n\n\n\n    function movePic(event) {\n\n        if (event.target.checked) {\n            myEditor.canvas.setAttribute('class', (myEditor.canvas.className + \" is-moving\").trim());\n            myEditor.canvas.addEventListener('mousedown', startMove);\n            myEditor.canvas.addEventListener('mousemove', moving);\n            myEditor.canvas.addEventListener('mouseup', endMove);\n            myEditor.canvas.addEventListener('mouseout', endMove);\n\n\n        } else {\n            myEditor.canvas.setAttribute('class', myEditor.canvas.className.replace(\"is-moving\", \"\").trim());\n            myEditor.canvas.removeEventListener('mousedown', startMove);\n            myEditor.canvas.removeEventListener('mousemove', moving);\n            myEditor.canvas.removeEventListener('mouseup', endMove);\n            myEditor.canvas.removeEventListener('mouseout', endMove);\n        }\n    }\n\n    function cropPic(event) {\n\n        if (event.target.checked) {\n            appState.offset = getOffset(myEditor.canvas);\n            myEditor.canvas.setAttribute('class', (myEditor.canvas.className + \" is-cropping\").trim());\n            myEditor.canvas.addEventListener('mousedown', startCrop);\n            myEditor.canvas.addEventListener('mousemove', cropping);\n            myEditor.canvas.addEventListener('mouseup', endCrop);\n            myEditor.canvas.addEventListener('mouseout', endCrop);\n        } else {\n            myEditor.canvas.setAttribute('class', myEditor.canvas.className.replace(\"is-cropping\", \"\").trim());\n            myEditor.canvas.removeEventListener('mousedown', startCrop);\n            myEditor.canvas.removeEventListener('mousemove', cropping);\n            myEditor.canvas.removeEventListener('mouseup', endCrop);\n            myEditor.canvas.removeEventListener('mouseout', endCrop);\n        }\n    }\n\n    function save(event){\n        saveButton.href=myEditor.canvas.toDataURL(myEditor.mimeType);\n        saveButton.download = myEditor.fileName;\n    }\n\n    function rotate(event){\n        console.log('rotate ' +  parseFloat(event.currentTarget.value));\n\n             myEditor.rotate(parseFloat(event.currentTarget.value));\n             myEditor.saveState();\n\n\n    }\n\n    function undo(){\n        myEditor.undo();\n    }\n\n    function redo(){\n        myEditor.redo();\n    }\n\n    fileInput.addEventListener('change', addPic);\n    scaleControl.addEventListener('input', scalePic);\n    scaleControl.addEventListener('blur', saveState);\n    undoControl.addEventListener('click', undo);\n    redoControl.addEventListener('click', redo);\n\n    cropControl.addEventListener('change', cropPic);\n    saveButton.addEventListener('click', save);\n    rotateLeft.addEventListener('click', rotate);\n    rotateRight.addEventListener('click', rotate);\n\n}());\n"]}