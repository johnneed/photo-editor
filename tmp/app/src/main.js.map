{"version":3,"sources":["../../../app/src/main.js"],"names":[],"mappings":"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","file":"main.js","sourcesContent":["import {default as Editor} from './editor';\nimport {getOffset} from \"./utilities\";\nimport EditorState from \"./editor-state\";\n\n\n(function () {\n    \"use strict\";\n    var isAdvancedUpload = function () {\n        var div = document.createElement('div');\n        return (('draggable' in div) || ('ondragstart' in div && 'ondrop' in div)) && 'FormData' in window && 'FileReader' in window;\n    }();\n    var fileInput = document.getElementById(\"fileInput\");\n    var scaleControl = document.getElementById(\"scaleImageControl\");\n    var cropControl = document.getElementById(\"cropImageControl\");\n    var editorBox = document.getElementById(\"editor\");\n    var saveButton = document.getElementById(\"save\");\n    var rotateRight = document.getElementById(\"rotateRight\");\n    var rotateLeft = document.getElementById(\"rotateLeft\");\n    var undoControl = document.getElementById(\"undoControl\");\n    var redoControl = document.getElementById(\"redoControl\");\n    var uploadInstructions = document.getElementById('uploadInstructions');\n    var clearImageControl = document.getElementById('clearImageControl');\n    var zoomControl = document.getElementById('zoomControl');\n    var spinner = document.getElementById('spinner');\n    var myEditor;\n\n    let appState = {\n        mouseStartX: null,\n        mouseStartY: null,\n        mouseEndX: null,\n        mouseEndY: null,\n        offset: null,\n        canvasWidth: null,\n        canvasHeight: null,\n        isMoving: null,\n        isCropping: null\n    };\n\n    function addPic(event) {\n        event.stopPropagation();\n        event.preventDefault();\n\n        myEditor = new Editor((event.target.files || event.dataTransfer.files)[0]);\n        while (editorBox.hasChildNodes()) {\n            editorBox.removeChild(editorBox.lastChild);\n        }\n        editorBox.appendChild(myEditor.canvas);\n        appState.offset = getOffset(myEditor.canvas);\n\n        appState.canvasWidth = myEditor.canvas.width;\n        appState.canvasHeight = myEditor.canvas.height;\n\n        window.editor = myEditor;\n        saveButton.setAttribute('href', myEditor.save());\n\n        uploadInstructions.className += \" is-hidden\";\n    }\n\n    function dragEnd(event) {\n        event.preventDefault();\n        event.stopPropagation();\n        uploadInstructions.className = uploadInstructions.className.replace('is-dragover', \"\").trim();\n    }\n\n    function dragStart(event) {\n        event.preventDefault();\n        event.stopPropagation();\n        uploadInstructions.className += (/is-dragover/).test(uploadInstructions.className) ? \"\" : \" is-dragover\";\n    }\n\n    function endMove(e) {\n        var canMouseX = parseInt(e.clientX, 10) - appState.mouseStartX;\n        var canMouseY = parseInt(e.clientY, 10) - appState.mouseStartY;\n        if (appState.isMoving) {\n            myEditor.move({\n                x: (canMouseX),\n                y: (canMouseY)\n            });\n            myEditor.saveState();\n        }\n        // clear the move flag\n        appState.isMoving = false;\n    }\n\n    function cropPic(event) {\n\n        if (event.target.checked) {\n            appState.offset = getOffset(myEditor.canvas);\n            myEditor.canvas.setAttribute('class', (myEditor.canvas.className + \" is-cropping\").trim());\n            myEditor.canvas.addEventListener('mousedown', startCrop);\n            myEditor.canvas.addEventListener('mousemove', cropping);\n            myEditor.canvas.addEventListener('mouseup', endCrop);\n            myEditor.canvas.addEventListener('mouseout', endCrop);\n        } else {\n            myEditor.canvas.setAttribute('class', myEditor.canvas.className.replace(\"is-cropping\", \"\").trim());\n            myEditor.canvas.removeEventListener('mousedown', startCrop);\n            myEditor.canvas.removeEventListener('mousemove', cropping);\n            myEditor.canvas.removeEventListener('mouseup', endCrop);\n            myEditor.canvas.removeEventListener('mouseout', endCrop);\n        }\n    }\n\n    function cropping(e) {\n        var canMouseX = parseInt(e.clientX, 10) - appState.mouseStartX;\n        var canMouseY = parseInt(e.clientY, 10) - appState.mouseStartY;\n        // if the crop flag is set, clear the canvas and draw the image\n        if (appState.isCropping) {\n            drawInvertedBox({\n                x: appState.mouseStartX - appState.offset.left,\n                y: appState.mouseStartY - appState.offset.top,\n                width: canMouseX,\n                height: canMouseY\n            });\n        }\n    }\n\n    function drawBox(args) {\n        args = args || {};\n        myEditor.redrawImage();\n        myEditor.canvasContext.fillStyle = 'rgba(255,255,255,0.4)';\n        myEditor.canvasContext.fillRect((args.x || 0), (args.y || 0), (args.width || 0), (args.height || 0));\n    }\n\n    function drawInvertedBox(args) {\n\n        args = args || {};\n\n        var canvasWidth = myEditor.canvas.width;\n        var canvasHeight = myEditor.canvas.height;\n\n        if (args.width < 0) {\n            args.x = args.x + args.width;\n            args.width = Math.abs(args.width);\n        }\n        if (args.height < 0) {\n            args.y = args.y + args.height;\n            args.height = Math.abs(args.height);\n        }\n\n        myEditor.redrawImage();\n        myEditor.canvasContext.beginPath();\n        myEditor.canvasContext.fillStyle = 'rgba(255,255,255,0.4)';\n        myEditor.canvasContext.fillRect(0, 0, args.x, canvasHeight);\n        myEditor.canvasContext.beginPath();\n        myEditor.canvasContext.fillRect(args.x + args.width, 0, canvasWidth - args.x - args.width, canvasHeight);\n        myEditor.canvasContext.beginPath();\n        myEditor.canvasContext.fillRect(args.x, 0, args.width, args.y);\n        myEditor.canvasContext.beginPath();\n        myEditor.canvasContext.fillRect(args.x, args.y + args.height, args.width, canvasHeight - args.height - args.y);\n\n\n    }\n\n    function endCrop(e) {\n        appState.mouseEndX = parseInt(e.clientX, 10) - appState.mouseStartX;\n        appState.mouseEndY = parseInt(e.clientY, 10) - appState.mouseStartY;\n        if (appState.isCropping) {\n            myEditor.crop({\n                x: (appState.mouseEndX > 0) ? appState.mouseStartX - appState.offset.left : parseInt(e.clientX, 10) - appState.offset.left,\n                y: (appState.mouseEndY > 0) ? appState.mouseStartY - appState.offset.top : parseInt(e.clientY, 10) - appState.offset.top,\n                width: Math.abs(appState.mouseEndX),\n                height: Math.abs(appState.mouseEndY)\n            })\n        }\n        // clear the crop flag\n        appState.isCropping = false;\n    }\n\n    function historyChange(event) {\n\n        if (event.detail.isFirst) {\n            undoControl.setAttribute('disabled', 'disabled');\n        } else {\n            undoControl.removeAttribute('disabled');\n\n        }\n        if (event.detail.isLast) {\n            redoControl.setAttribute('disabled', 'disabled');\n\n        } else {\n            redoControl.removeAttribute('disabled');\n\n        }\n    }\n\n    function moving(e) {\n        var canMouseX = parseInt(e.clientX, 10) - appState.mouseStartX;\n        var canMouseY = parseInt(e.clientY, 10) - appState.mouseStartY;\n        // if the move flag is set, clear the canvas and draw the image\n        if (appState.isMoving) {\n            myEditor.move({\n                x: canMouseX,\n                y: canMouseY\n            });\n            //   myEditor.canvasContext.clearRect(0, 0, canvasWidth, canvasHeight);\n            //   myEditor.canvasContext.drawImage(myEditor.originalImage, canMouseX - 128 / 2, canMouseY - 120 / 2, 128, 120);\n        }\n    }\n\n    function movePic(event) {\n\n        if (event.target.checked) {\n            myEditor.canvas.setAttribute('class', (myEditor.canvas.className + \" is-moving\").trim());\n            myEditor.canvas.addEventListener('mousedown', startMove);\n            myEditor.canvas.addEventListener('mousemove', moving);\n            myEditor.canvas.addEventListener('mouseup', endMove);\n            myEditor.canvas.addEventListener('mouseout', endMove);\n\n\n        } else {\n            myEditor.canvas.setAttribute('class', myEditor.canvas.className.replace(\"is-moving\", \"\").trim());\n            myEditor.canvas.removeEventListener('mousedown', startMove);\n            myEditor.canvas.removeEventListener('mousemove', moving);\n            myEditor.canvas.removeEventListener('mouseup', endMove);\n            myEditor.canvas.removeEventListener('mouseout', endMove);\n        }\n    }\n\n    function redo() {\n        myEditor.redo();\n    }\n\n    function rotate(event) {\n        myEditor.rotate(parseFloat(event.currentTarget.value));\n        myEditor.saveState();\n\n\n    }\n\n    function save(event) {\n        saveButton.href = myEditor.canvas.toDataURL(myEditor.mimeType);\n        saveButton.download = myEditor.fileName;\n    }\n\n    function saveState(event) {\n\n        myEditor.saveState();\n        scaleControl.max = (myEditor.originalImage.height / myEditor.currentState().image.height) * 100;\n        scaleControl.value = 100;\n\n    }\n\n    function scalePic(event) {\n        myEditor.scale(event.target.value);\n    }\n\n    function startCrop(e) {\n        appState.mouseStartX = parseInt(e.clientX, 10);\n        appState.mouseStartY = parseInt(e.clientY, 10);\n        // set the crop flag\n        appState.isCropping = true;\n    }\n\n    function startMove(e) {\n        appState.mouseStartX = parseInt(e.clientX, 10);\n        appState.mouseStartY = parseInt(e.clientY, 10);\n        // set the move flag\n        appState.isMoving = true;\n    }\n\n    function startOver(event) {\n        editorBox.removeChild(myEditor.canvas);\n        myEditor = null;\n        fileInput.value = null;\n        uploadInstructions.className = uploadInstructions.className.replace(\"is-hidden\", \"\").trim();\n    }\n\n    function undo() {\n        myEditor.undo();\n    }\n\n    function zoomPic(event){\n        myEditor.zoom(parseInt(event.target.value, 10));\n    }\n\n    function toggleSpinner(action){\n        var isHidden = /is-hidden/.test(spinner.className);\n        switch (action){\n            case 'hide' :\n                spinner.className = isHidden ? spinner.className.trim() : spinner.className + \" is-hidden\";\n                break;\n            case 'show' :\n                spinner.className = isHidden ? spinner.className.replace(\"is-hidden\", \"\").trim() : spinner.className.trim();\n                break;\n            default :\n                spinner.className = isHidden ? spinner.className.replace(\"is-hidden\", \"\").trim() :  spinner.className + \" is-hidden\";\n                break;\n        }\n    }\n\n    document.body.addEventListener('historyIndexChange', historyChange);\n\n\n    fileInput.addEventListener('change', addPic);\n    scaleControl.addEventListener('input', scalePic);\n    scaleControl.addEventListener('blur', saveState);\n    undoControl.addEventListener('click', undo);\n    redoControl.addEventListener('click', redo);\n\n    cropControl.addEventListener('change', cropPic);\n    saveButton.addEventListener('click', save);\n    rotateLeft.addEventListener('click', rotate);\n    rotateRight.addEventListener('click', rotate);\n    clearImageControl.addEventListener('click', startOver);\n    zoomControl.addEventListener('input', zoomPic);\n    if (isAdvancedUpload) {\n        uploadInstructions.className += \" has-advanced-upload\";\n        uploadInstructions.addEventListener(\"dragover\", dragStart);\n        uploadInstructions.addEventListener(\"dragleave\", dragEnd);\n        uploadInstructions.addEventListener(\"drop\", addPic);\n    }\n\n}());\n"]}